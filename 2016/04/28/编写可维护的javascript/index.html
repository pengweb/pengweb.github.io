<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title> 编写可维护的javascript | 张鹏的全栈之路 </title>
	<meta property="og:title" content=" 编写可维护的javascript | 张鹏的全栈之路 " />
	<meta name="twitter:title" content=" 编写可维护的javascript | 张鹏的全栈之路 ">

	<meta property="og:type" content="article">
	<meta name="twitter:card" content="summary">

	<meta name="description" content=" 编写可维护的javascript | 张鹏的全栈之路 ">
	<meta property="og:description" content=" 编写可维护的javascript | 张鹏的全栈之路 " />
	<meta name="twitter:description" content=" 编写可维护的javascript | 张鹏的全栈之路 " />

	<link rel="icon" type="image/x-icon" href="/asset/img/favicon.png">

	<link rel="image_src" href="/asset/img/logo.png" >
	<meta property="og:image" content="/asset/img/logo.png" />

	<link href="http://yoursite.com/atom.xml" title="张鹏的全栈之路" type="application/atom+xml" rel="alternative">

	<link rel="canonical" href="/2016/04/28/编写可维护的javascript/index.html">

	<link rel="stylesheet" href="/asset/css/style.css">

</head>

<body>

	<div class="layout-header">
		<header class="header">
			<div class="layout-logo">
				<div class="panel-logo">

					<div class="box-logo box-log-md">
						<a href="/" title="张鹏的全栈之路"><img src="/asset/img/logo.png" class="img-logo"></a>
					</div>
					<div class="box-main-title">
						<h5 style="text-align: center">
							<span>Love life,love ourselves！--Pengzhang</span>
						</h5>
					</div>
					<div class="box-sub-title">

					</div>
				</div>
			</div>
			<div class="layout-menu">
				<div class="box-logo box-log-xs">
					<a href="/" title="张鹏的全栈之路"><img src="/asset/img/logo.png" class="img-logo"></a>
				</div>
				<div class="box-menu-list">
					<nav class="page-nav">
						<ul class="menu-list">

							<li class="box-menu-item"><a href="/"><span class="menu-item">HOME</span></a></li>

							<li class="box-menu-item"><a href="/tags/js"><span class="menu-item">Javascript</span></a></li>

							<li class="box-menu-item"><a href="/tags/nodejs"><span class="menu-item">Node.js</span></a></li>

							<li class="box-menu-item"><a href="/tags/html"><span class="menu-item">Html</span></a></li>

							<li class="box-menu-item"><a href="/tags/css"><span class="menu-item">Css</span></a></li>

							<li class="box-menu-item"><a href="/tags/note"><span class="menu-item">Note</span></a></li>

							<li class="box-menu-item"><a href="/tags/others"><span class="menu-item">Others</span></a></li>

						</ul>
					</nav>

				</div>
			</div>
		</header>
	</div>

	<div class="layout-content">


		<div class="row panel-content panel-post-item">
			<div class="box-post-item">
				<article class="post-item" itemscope itemtype="http://schema.org/Article">




					<p class="content-meta">
						<span class="meta-date" itemprop="datePublished" content="2016-04-28">2016-04-28</span>


					</p>


					<h2 class="box-content-title">
						<a href="/2016/04/28/编写可维护的javascript/"  itemprop="url"><span class="content-title" itemprop="name">编写可维护的javascript</span></a>
					</h2>

					<div class="content post-item-content" itemprop="articleBody">

<h1 id="1-基本的格式化"><a href="#1-基本的格式化" class="headerlink" title="1.基本的格式化"></a>1.基本的格式化</h1><p>1.缩进推荐用<code>tab</code><br>2.语句结尾用<code>;</code><br>3.return后边加一个空格之后跟<code>{</code><br>4.每行不要超过80个字符<br>5.运算符<code>,</code>后换行，运算符不要放到第二行，且换行后用两个缩进<br>6.在<code>if</code>这种控制语句之前，<code>function</code>之间，<code>var</code>之后，注释之前，逻辑片段之间插入<strong>空行</strong><br>7.变量名驼峰大小写<br>8.函数名前缀为动词<br>9.常量大写字母和下划线命名<br>10.构造函数，首字母也要大写<br>11.字符串最好用<code>&quot;&quot;</code>,因为java通常都是双引号，来回切换的时候不会混<br>12.字符串需要换行的时候用<code>+</code>进行连接<br>13.数字不要省略小数点之前和之后的数字<br>14.禁用八进制<br>15.<code>null</code>最好的用法是当作对象的占位符，初始化一个对象。<br>16.没有被初始化的变量都有一个初始值<code>undefined</code><br>17.定义对象和数组请用直接量<code>[]</code> <code>{}</code></p>
<h1 id="2-注释"><a href="#2-注释" class="headerlink" title="2.注释"></a>2.注释</h1><p>1.注释之前有空行<br>2.单行注释用<code>//</code>，但是如果是注释代码的话，多行也可以用这个<br>3.多行注释用<code>/**/</code>,包含中文的多行也要用这个<br>4.注释要和下边被注释的代码对齐<br>5.注释<code>*</code>后加一个空格<br>6.用<code>@</code>表示属性<br>一般注释<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * 一般注释</span><br><span class="line"> *</span><br><span class="line"> */</span><br></pre></td></tr></table></figure></p>
<p>文档注释<br>/<strong><br>这里是文档说明，属性放在最后<br>@method 这里写注释<br>@param {Object} 被合并的一个或多个对象<br>@return {Object} 一个新合并的对象
</strong>/<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 3.语句和表达式</span><br><span class="line">1.花括号更在条件后边</span><br><span class="line">2.圆括号两边没有空格，语句和左花括号之间都有空格,webstrom的默认格式(Ctrl+Alt+L)</span><br><span class="line">3.switch语句case需要缩进</span><br><span class="line">4.`case`之间无`break`且无语句，可以直接连续执行；</span><br><span class="line">5.两个连续`case`语句都执行的话，需要在第二个之前加`/**/`注释才不会报错</span><br><span class="line">6.`default`推荐不要写，但是加个注释`// 无 default`</span><br><span class="line">7.`for`循环通过`break`退出整个循环，`continue`跳过此次循环，进入下一次循环</span><br><span class="line">8.推荐用条件语句代替`continue`,使用continue的话JSLint会警告，JSHint不会</span><br><span class="line">9.`for-in`是遍历对象的，不要用来遍历数组</span><br><span class="line">10.`for-in`在循环体内最好做一个`hasOwnProperty()`的判断，如果没有会出现警告</span><br><span class="line"></span><br><span class="line"># 4.变量、函数和运算符</span><br><span class="line">1.`var`都放到最上边</span><br><span class="line">2.没有初始值的变量，写在所有的var语句之后</span><br><span class="line">3.函数声明也都写在最前边</span><br><span class="line">4.函数声明不要出现在语句块中</span><br><span class="line">5.函数调用时，函数名和左括号之间没有空格</span><br><span class="line">6.被赋值的立即调用函数，为了能一眼看出是立即调用，应该在最外层加个`()`</span><br><span class="line">7.严格模式最好加在函数内，防止合并的时候，造成全局严格模式</span><br><span class="line">8.`use strict`出现在函数体之外的时候会出现警告</span><br><span class="line">9.最好用`===` `!==`来进行判断</span><br><span class="line">10.都会先转化为`Number()`进行比较,不行的话继续转化为`valueOf()`，还不行就转化为`toString()`</span><br><span class="line"></span><br><span class="line"># 5.UI层的松耦合</span><br><span class="line">## 5.1 将javascript从css中抽离</span><br><span class="line">css中不要写javascript</span><br><span class="line"></span><br><span class="line">## 5.2 CSS从javascript中抽离</span><br><span class="line">都用`className` 来处理</span><br><span class="line">```js</span><br><span class="line">//原生</span><br><span class="line">element.className += &apos;reveal&apos; </span><br><span class="line">//HTML5</span><br><span class="line">element.classList.add(&apos;reveal&apos;)</span><br><span class="line">//jQuery</span><br><span class="line">element.addClass(&quot;reveal&quot;)</span><br></pre></td></tr></table></figure></p>
<h2 id="5-3-javascript从HTML中抽离"><a href="#5-3-javascript从HTML中抽离" class="headerlink" title="5.3 javascript从HTML中抽离"></a>5.3 javascript从HTML中抽离</h2><p>通过监听事件，不要直接写在html中</p>
<h2 id="5-4-将HTML从javascript中抽离"><a href="#5-4-将HTML从javascript中抽离" class="headerlink" title="5.4 将HTML从javascript中抽离"></a>5.4 将HTML从javascript中抽离</h2><p>方法一：从服务器加载<br>将模板放置于远程服务器，然后通过ajax来调用，通过innerHTML来插入<br>方法二：简单客户端模板<br>原理：HTML模板中将给要添加数据的位置添加个占位符s%，然后在js中将这个占位符替换为真实数据sprintf()，然后再将数据插入到应该的位置。<br>模板HTML中存在有两种方式：<br>1.注释<br>2.script标签中，令type=”text/x-my-template”</p>
<p>方法三：复杂客户端模板<br>handlebars模板引擎</p>
<h1 id="6-避免使用全局变量"><a href="#6-避免使用全局变量" class="headerlink" title="6.避免使用全局变量"></a>6.避免使用全局变量</h1><p>1.任何全局作用域中的声明的变量和函数都是<code>window</code>对象的属性<br>2.不加<code>var</code>的变量都是全局变量</p>
<h2 id="6-3-单全局变量的方式"><a href="#6-3-单全局变量的方式" class="headerlink" title="6.3 单全局变量的方式"></a>6.3 单全局变量的方式</h2><p>方法一：命名空间<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">common.zhp=&#123;&#125;    <span class="comment">//这个zhp就是我自己的命名空间，所有我的属性和方法都定义到zhp上</span></span><br></pre></td></tr></table></figure></p>
<p>方法二：模块<br>requirejs或者seajs等模快化工具<br>通过define()和require()来实现的<br>现在的webpack也同样可以实现<br>还有ES6也加入了模块API</p>
<p>方法三：零全局变量<br>定义一个自执行函数，在这个函数内就不会产生全局变量了</p>
<h1 id="7-事件处理"><a href="#7-事件处理" class="headerlink" title="7.事件处理"></a>7.事件处理</h1><p>1.隔离应用逻辑<br>2.不要分发事件对象，就是说event只能出现在处理事件程序里，不应该出现在应用逻辑内。<br>让事件处理程序称为接触到<code>event</code>对象的<strong>唯一</strong>的函数<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P87</span></span><br></pre></td></tr></table></figure></p>
<h1 id="8-避免空比较"><a href="#8-避免空比较" class="headerlink" title="8.避免空比较"></a>8.避免空比较</h1><h2 id="8-1-检测原始值"><a href="#8-1-检测原始值" class="headerlink" title="8.1 检测原始值"></a>8.1 检测原始值</h2><p><code>typeof</code>检查，推荐后边无括号<br>只检查<code>string</code>,<code>number</code>,<code>boolean</code>,<code>undefined</code>用<br>判断<code>null</code>用<code>===</code></p>
<h2 id="8-2-检测引用值"><a href="#8-2-检测引用值" class="headerlink" title="8.2 检测引用值"></a>8.2 检测引用值</h2><p><code>instanceof</code>检查是否是<strong>的实例<br>因为</strong>会检测原型链<strong>，所以会不准确<br>所以检测函数和数组的时候都</strong>不用这个**</p>
<h2 id="8-3-检测函数"><a href="#8-3-检测函数" class="headerlink" title="8.3 检测函数"></a>8.3 检测函数</h2><p>通过<code>in</code>运算符来检测，这是最安全的做法<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">"querySelectorAll"</span> <span class="keyword">in</span> <span class="built_in">document</span>)&#123;</span><br><span class="line">    <span class="comment">//检测querySelectorAll是否是DOM的方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="8-4检测数组"><a href="#8-4检测数组" class="headerlink" title="8.4检测数组"></a>8.4检测数组</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.toString.call(value) === <span class="string">"[object Array]"</span></span><br></pre></td></tr></table></figure>
<p>自定义对象不要用这种方法（json）<br><strong>推荐</strong>用 <code>isArray()</code>方法</p>
<h2 id="8-5检测属性"><a href="#8-5检测属性" class="headerlink" title="8.5检测属性"></a>8.5检测属性</h2><p>检测属性是否存在是最好的方法是使用<code>in</code>运算符！<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">"count"</span> <span class="keyword">in</span> object)&#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>检测实例对象的时候记得使用hasOwnProperty()方法<br>且最好先判断下hasOwnProperty是否存在<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="string">"hasOwnProperty"</span> <span class="keyword">in</span> object &amp;&amp; object.hasOwnProperty(<span class="string">"related"</span>))&#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="9-将配置数据从代码中分离出来"><a href="#9-将配置数据从代码中分离出来" class="headerlink" title="9.将配置数据从代码中分离出来"></a>9.将配置数据从代码中分离出来</h1><p>定义一个配置数据对象<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="keyword">default</span> = &#123;</span><br><span class="line">    config1:<span class="string">''</span>,</span><br><span class="line">    config2:<span class="string">''</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>注意</em>自己在封装的时候，要给用户单设置一个配置文件，然后通过用户配置的和默认的配置文件比较进行初始化</p>
<h1 id="10-抛出自定义错误"><a href="#10-抛出自定义错误" class="headerlink" title="10.抛出自定义错误"></a>10.抛出自定义错误</h1><p>没细看，用的少</p>
<h1 id="11-不是你的对象不要用"><a href="#11-不是你的对象不要用" class="headerlink" title="11.不是你的对象不要用"></a>11.不是你的对象不要用</h1><p>1.不覆盖<br>2.不新增<br>3.不删除（为null）</p>
<h2 id="11-3-更好的途径"><a href="#11-3-更好的途径" class="headerlink" title="11.3 更好的途径"></a>11.3 更好的途径</h2><p>1.基于对象的继承<br><code>Object.create()</code></p>
<p>2.基于类型的继承<br>组合式继承（原型链+借用构造函数）<br>推荐看高级程序设计</p>
<h2 id="11-5阻止修改"><a href="#11-5阻止修改" class="headerlink" title="11.5阻止修改"></a>11.5阻止修改</h2><p>Object.preventExtension() 锁定，禁止扩展<br>Object.isExtensible()  检测是否禁止扩展<br>Object.seal() 封装<br>Object.isSealed() 检测是否封装<br>Object.freeze() 冻结<br>Object.isFrozen() 检测是否冻结</p>
<h1 id="12-浏览器嗅探"><a href="#12-浏览器嗅探" class="headerlink" title="12.浏览器嗅探"></a>12.浏览器嗅探</h1><p>用<strong>特性检测</strong><br>不要用<strong>特性推断</strong></p>

					</div>


					<div class="content-tag">

<a class="tag-link" href="/tags/javascript/">javascript</a>, <a class="tag-link" href="/tags/js/">js</a>, <a class="tag-link" href="/tags/note/">note</a>

					</div>



				</article>
			</div>

		</div>

		<div class="panel-post-nav">
			<div class="box-post-nav">


					<a href="/2016/04/29/SVG-学习笔记/" title="SVG--学习笔记">&larr; Prev</a>



					<a href="/2016/04/21/rem实现Sprite雪碧图/" title="rem实现Sprite雪碧图">Next &rarr;</a>


			</div>
		</div>
		<div class="content-comments">
		
  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2016/04/28/编写可维护的javascript/index.html" data-title="编写可维护的javascript" data-url="/2016/04/28/编写可维护的javascript/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'pengweb'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->
  </section>
  
		</div>
		

	</div>

	<div class="layout-footer" style="clear: both">
		<div class="panel-footer">
			<div class="box-footer">
				<footer class="footer">
					<p class="cr">&copy; 2016 <a href="https://github.com/pengweb"  target="_blank" target="_blank">Pengzhang</a> 
					<span class="theme">Powered: <a href="https://github.com/pengweb/pengweb.github.io" target="_blank">pengweb.net</a>, 京ICP备: <a href="" target="_blank">15017479</a></span>
					</p>

					
				</footer>
			</div>
		</div>
	</div>




</body>
</html>
